\section{Rings and Modules of Fractions}
The formation of rings of fractions and the associated process of localization are perhaps the most important technical tools in commutative algebra. They correspond in the algebro-geometric picture to concentrating attention on an open set or near a point, and the importance of these notions should be self-evident. This section gives the definitions and simple properties of the formation of fractions.
\subsection{Basic Concepts}
In this section we shall sketch a brief review of the fraction of a ring. Most results presented here have been introduced in Section 4.4.\par
Recall the construction of the ring of fractions as developed in Section 34.4. Let $A$ be any ring. A \textbf{multiplicative subset} $S$ of $A$ is defined to be a subset of $A$ such that $1\in S$, and $S$ is closed under multiplication. Therefore $S$ is indeed a sub-semigroup of $A$. Define a relation $\sim$ on $A\times S$ as follows: 
$$(a,s)\sim (b,t)\iff (at-bs)u=0\ \text{for some}\ u\in S.$$
Clearly this is an equivalent relation. Let $a/s$ denote the equivalence class of $(a,s)$ and let $S^{-1}A$ denote the set of equivalence classes. We put a ring structure on $S^{-1}A$ by defining addition and multiplication of these "fractions" $a/s$ in the same way as in elementary algebra.\par
The ring of fractions $S^{-1}A$ may be characterized by the following universal property. Let $g:A\to B$ be a ring homomorphism such that $g(s)$ is a unit in $B$ for all $s\in S$. Then there exists a unique ring homomorphism $h:S^{-1}A\to B$ such that $g=h\circ f$. Here is a Corollary of the universal property of the ring of fractions that may be useful: 
\begin{corollary}
If $g:A\to B$ is a ring homomorphism such that \par
(i) $s\in S$ implies $g(s)$ is a unit in $B$;\par
(ii) $g(a)=0$ implies $as=0$ for some $s\in S$;\par
(iii) Every element of $B$ is of the form $g(a)g(s)^{-1}$,\par
then there is a unique isomorphism $g:S^{-1}A\to B$ such that $g=h\circ f$.
\end{corollary}
\begin{proof}
By the universal property of $S^{-1}A$ we know that there exists a homomorphism $h:S^{-1}A\to B$ such that $g=g\circ f$. Now it suffices to show that $h$ is indeed an isomorphism. Note that $h\left( a/s \right) =g\left( a \right) g\left( s \right) ^{-1}$, we have $h$ is surjective by (iii). Now if $h(a/s)=0$, then $g(a)=0$, which implies $at=0$ for some $t\in S$ and hence $a/s=0$ in $S^{-1}A$.
\end{proof}
Now we offer some examples.
\begin{example}\em
(i) Let $\mathfrak{p}$ be a prime ideal of $A$. Then $S=A-\mathfrak{p}$ is a multiplicative subset. We write $A_\mathfrak{p}$ for $S^{-1}A$ in this case. The elements $a/s$ with $a\in\mathfrak{p}$ form an ideal $\mathfrak{m}$ in $A_\mathfrak{p}$. It is the unique maximal ideal of $A_\mathfrak{p}$; in other words, $A_\mathfrak{p}$ is a local ring. Such process of passing $A$ to $A_\mathfrak{p}$ is called \textbf{localization} at $\mathfrak{p}$.\par
(ii) $S^{-1}A$ is the zero ring if and only if $0\in S$. To see this, suppose $S^{-1}A$ is the zero ring, therefore $(a,s)\sim(0,t)$ for some $t\in S$. Therefore $atu=0$ for some $u$ and hence $t=0$. Conversely, suppose $s=0\in S$, then for all $a\in A$ and $t\in S$ we have $(a,s)\sim (0,t)$ and hence $a/s=0$.\par
(iii) Let $f\in A$ and $S=\{f^n\}_{n\ge 0}$. Then $S$ is a multiplicative subset of $A$ and we shall denote $S^{-1}A$ as $A_f$.\par
(iv) Let $\mathfrak{a}$ be an ideal of $A$ and let $S=1+\mathfrak{a}$. Then $S$ is a multiplicative subset of $A$ and we may define $S^{-1}A$.\par
For some special cases, see\par
(v) Consider the ring $\mathbb{Z}$. $(p)$ is a prime ideal of $\mathbb{Z}$ if $p$ is a prime number. Then the ring $\mathbb{Z}_{(p)}$ is the ring of all fractions $m/n$ with $n$ prime to $p$. If $f\in\mathbb{Z}$ and $f\ne 0$, then $\mathbb{Z}_f$ is the set of all rational numbers whose denominator is a power of $f$.\par
(vi) Consider the ring $k[t_1,\cdots,t_n]$, where $k$ is a field. Suppose $\mathfrak{p}$ is a prime ideal of $k$, then if we denote $A=k[t_1,\cdots,t_n]$, $A_\mathfrak{p}$ is the ring consists of all rational functions $f/g$ such that $g\notin\mathfrak{p}$. Let $V=\{x=(x_1,\cdots,x_n)\in k^n: f(x)=0, f\in\mathfrak{p}\}$ be the variety defined by the prime ideal $\mathfrak{p}$, then (provided $k$ is infinite) $A\mathfrak{p}$ can be identified with the ring of all rational functions on $k^n$ which are defined at almost all points of $V$; it is the local ring of $k^n$ \textbf{along the variety $V$}. This is the prototype of the local rings which arise in algebraic geometry.
\end{example}
The construction of $S^{-1}A$ may be carried through with an $A$-module $M$ in place of the ring $A$. Define a relation $\sim$ on $M\times S$ as follows: 
$$(m,s)\sim (m^\prime,s^\prime)\iff t(sm^\prime-s^\prime m)=0\ \text{for some}\ t\in S.$$
As before, this is an equivalence relation. Let $m/s$ denote the equivalence class of the pair $(m,s)$, let $S^{-1}M$ be the set of such fractions, then we may make $S^{-1}M$ into an $S^{-1}A$-module with obvious definitions of addition and scalar multiplication. As in Example 8.1 (i) and (iii), we shall write $M_\mathfrak{p}$ when $S=A-\mathfrak{p}$ and $M_f$ when $S=\{f^n\}_{n\ge 0}$.\par
Let $u:M\to N$ be a homomorphism of $A$-modules. Then it give rise to an $S^{-1}A$-module homomorphism $S^{-1}u\to S^{-1}M\to S^{-1}N$, namely $S^{-1}u$ maps $m/s$ to $u(m)/s$. We have immediately by definition that $S^{-1}(N+P)=S^{-1}N+S^{-1}P$, $S^{-1}(N\cap P)=(S^{-1}N)\cap(S^{-1}P)$, and $S^{-1}(u\circ v)=(S^{-1}u)\circ(S^{-1}v)$.
\begin{proposition}
The operation $S^{-1}$ is exact, i.e. if $M^{\prime}\overset{f}{\longrightarrow}M\overset{g}{\longrightarrow}M^{\prime\prime}$ is exact at $M$, then $S^{-1}M^{\prime}\overset{S^{-1}f}{\longrightarrow}S^{-1}M\overset{S^{-1}g}{\longrightarrow}S^{-1}M^{\prime\prime}$ is exact at $S^{-1}M$.
\end{proposition}
\begin{proof}
First note that $g\circ f=0$. Therefore $s^{-1}(g\circ f)=(S^{-1}g)\circ(S^{-1}f)=0$ and hence $\mathrm{Im}(S^{-1}f)\subset\mathrm{Ker}(S^{-1}g)$. To prove the reverse inclusion, let $m/s\in\mathrm{Ker}(S^{-1}g)$, then $g(m/s)=g(m)/s=0$, hence there exists some $t\in S$ such that $tg(m)=g(tm)=0$, whence $tm\in\mathrm{Ker}g=\mathrm{Im}f$. Suppose $f(m^\prime)=tm$, consider $S^{-1}f(m^\prime/ts)=f(m^\prime)/ts=tm/ts=m/s$, hence $m/s\in\mathrm{Im}(S^{-1}g)$, which finished the proof.
\end{proof}
In particular, it follows that if $M^\prime$ is a submodule of $M$, the mapping $S^{-1}M^\prime\to S^{-1}M$ is injective and therefore $S^{-1}M^\prime$ can be regarded as a submodule of $S^{-1}M$.
\begin{corollary}
Suppose $M$ is an $A$-module and $N$ a submodule of $M$, then we have the isomorphism $S^{-1}(M/N)\cong(S^{-1}M)/(S^{-1}N)$.
\end{corollary}
\begin{proof}
Consider the short exact sequence 
$$
0\longrightarrow N\overset{\iota}{\longrightarrow}M\overset{\pi}{\longrightarrow}M/N\longrightarrow 0,
$$
apply $S^{-1}$ operator to obtain 
$$
0\longrightarrow S^{-1}N\overset{S^{-1}\iota}{\longrightarrow}S^{-1}M\overset{S^{-1}\pi}{\longrightarrow}S^{-1}\left( M/N \right) \longrightarrow 0,
$$
note that $\mathrm{Ker}(S^{-1}\pi)=\mathrm{Im}(S^{-1}\iota)=S^{-1}N$, we therefore have 
$$
S^{-1}\left( M/N \right) \cong \left( S^{-1}M \right) /\mathrm{Ker}\left( S^{-1}\pi \right) =\left( S^{-1}M \right) /\mathrm{Im}\left( S^{-1}\iota \right) \cong \left( S^{-1}M \right) /\left( S^{-1}N \right) ,
$$
which finished the proof.
\end{proof}
\begin{proposition}
Let $M$ be an $A$-module. Then the $S^{-1}$-modules $S^{-1}M$ and $S^{-1}A\otimes_AM$ are isomorphic under the isomorphism $f:S^{-1}A\otimes_AM\to S^{-1}M$ given by $(a/s)\otimes m\mapsto am/s$ for all $a\in A$, $m\in M$ and $s\in S$.
\end{proposition}
\begin{proof}
We first show that $f$ is well-defined. Indeed, observe that the map $((a/s),m)\mapsto am/s$ is a bilinear map, we therefore conclude that $f$ is well-defined by the universal property of tensor products. Trivially $f$ is surjective, we now show that $f$ is injective. First we show that every element in $S^{-1}A\otimes_AM$ is of the form $(1/s)\otimes m$. To see this, suppose $\sum_i(a_i/s_i)\otimes m_i$ be any element of $S^{-1}A\otimes_AM$. If $s=\prod_is_i\in S$, $t=\prod_{j\ne i}s_j$, we have 
$$
\sum_i{\frac{a_i}{s_i}\otimes m_i}=\sum_i{\frac{a_it_i}{s}\otimes m_i}=\sum_i{\frac{1}{s}\otimes a_it_im_i}=\frac{1}{s}\otimes \sum_i{a_it_im_i}=\frac{1}{s}\otimes m.
$$
Now suppose $(1/s)\otimes m\in\mathrm{Ker}f$. Then $m/s=0$, hence there exists some $t\in S$ such that $mt=0$, and hence 
$$
\frac{1}{s}\otimes m=\frac{t}{st}\otimes m=\frac{1}{st}\otimes tm=\frac{1}{st}\otimes 0=0,
$$
whence $(1/s)\otimes m=0$ and $f$ is an isomorphism.
\end{proof}
\begin{corollary}
$S^{-1}A$ is a flat $A$-module.
\end{corollary}
\begin{proof}
Suppose $0\longrightarrow M^{\prime}\longrightarrow M\longrightarrow M^{\prime\prime}\longrightarrow 0$ is a short exact sequence of $A$-modules, then $0\longrightarrow S^{-1}M^{\prime}\longrightarrow S^{-1}M\longrightarrow S^{-1}M^{\prime\prime}\longrightarrow 0$ is also a short exact sequence by Proposition 8.2. However by Proposition 8.4 we have the short exact sequence is equivalent to 
$$
0\longrightarrow S^{-1}A\otimes M^{\prime}\longrightarrow S^{-1}A\otimes M\longrightarrow S^{-1}A\otimes M^{\prime\prime}\longrightarrow 0
$$
which implies $S^{-1}A$ a flat $A$-module.
\end{proof}
\begin{proposition}
If $M$ and $N$ are $A$-modules, there is a unique isomorphism of $S^{-1}A$-modules $f:S^{-1}M\otimes_{S^{-1}A}S^{-1}N\to S^{-1}(M\otimes N)$ such that $(m/s)\otimes(n/t)\mapsto(m\otimes n)/st$. In particular, if $\mathfrak{p}$ is a prime ideal, then 
$$
M_{\mathfrak{p}}\otimes _{A_{\mathfrak{p}}}N_{\mathfrak{p}}\cong \left( M\otimes _AN \right) _{\mathfrak{p}}.
$$
\end{proposition}
\begin{proof}
We observe by Proposition 8.4 that 
$$
\begin{aligned}
S^{-1}M\otimes _{S^{-1}A}S^{-1}N&\cong \left( S^{-1}A\otimes _AM \right) \otimes _{S^{-1}A}\left( S^{-1}A\otimes _AN \right) =S^{-1}A\otimes _A\left( M\otimes _{S^{-1}A}S^{-1}A \right) \otimes _AN
\\
&\cong S^{-1}A\otimes _AM\otimes _AN=S^{-1}A\otimes _A\left( M\otimes _AN \right) =S^{-1}\left( M\otimes _AN \right) ,
\end{aligned}
$$
which finished the proof.
\end{proof}
\subsection{Local Properties}
A property $P$ of a ring $A$ is said to be a \textbf{local property} if $A$ (or $M$) has $P$ if and only if $A_\mathfrak{p}$ (or $M_\mathfrak{p}$) has $P$ for each prime ideal $\mathfrak{p}$ of $A$. In this section we shall introduce some local properties of a ring.
\begin{proposition}
Let $M$ be an $A$-module. Then the following are equivalent.\par
(i) $M=0$;\par
(ii) $M_\mathfrak{p}=0$ for all prime ideals $\mathfrak{p}$ of $A$;\par
(iii) $M_\mathfrak{m}=0$ for all maximal ideals $\mathfrak{m}$ of $A$.
\end{proposition}
\begin{proof}
The implication (i)$\Rightarrow$(ii)$\Rightarrow$(iii) are trivial. It suffices to show that (iii)$\Rightarrow$(i). To see this, note that if $M\ne 0$, there exists some $m\in M$ such that $m\ne 0$. Consider the ideal $\mathrm{Ann}(m)$, which is contained in some maximal ideal $\mathfrak{m}$. However $M_\mathfrak{m}=0$, h=therefore $m$ is killed by some elements $t\in A-\mathfrak{m}$, a contradiction!
\end{proof}
\begin{proposition}
Let $\phi$ be an $A$-module homomorphism. Then the following are equivalent: \par
(i) $\phi$ is injective;\par
(ii) $\phi_\mathfrak{p}:M_\mathfrak{p}\to N_\mathfrak{p}$ is injective for every prime ideal $\mathfrak{p}$;\par
(iii) $\phi_\mathfrak{m}:M_\mathfrak{m}\to N_\mathfrak{m}$ is injective for every maximal ideal $\mathfrak{m}$.\par
The statement is true with \textit{injective} replaced by \textit{surjective} throughout.
\end{proposition}
\begin{proof}
(i)$\Rightarrow$(ii): Suppose $0\longrightarrow M\longrightarrow N$ is exact, then $0\longrightarrow M_\mathfrak{p}\longrightarrow N_\mathfrak{p}$ is exact, whence $\phi_\mathfrak{p}$ is injective.\par
(ii)$\Rightarrow$(iii): Note that every maximal ideal is a prime ideal.\par
(iii)$\Rightarrow$(i): Consider the following exact sequence: 
$$
0\longrightarrow \mathrm{Ker}\phi \overset{\subset}{\longrightarrow}M\overset{\phi}{\longrightarrow}N.
$$
Now since $\mathfrak{m}$ is a maximal ideal, it is prime and hence 
$$
0\longrightarrow \mathrm{Ker}\phi _{\mathfrak{m}}\overset{\subset}{\longrightarrow}M_{\mathfrak{m}}\overset{\phi _{\mathfrak{m}}}{\longrightarrow}N_{\mathfrak{m}}
$$
is exact. Therefore $\mathrm{Ker}\phi_\mathfrak{m}=0$ since $\phi_\mathfrak{m}$ is injective by the hypothesis. This implies $\mathrm{Ker}\phi=0$ since $\mathrm{Ker}\phi_\mathfrak{m}=(\mathrm{Ker}\phi)_\mathfrak{m}$ and Proposition 8.7. Hence $\phi$ is injective.\par
To prove the surjective case, just reverse all the arrows in the proof above.
\end{proof}
Flatness is a local property: 
\begin{proposition}
For any $A$-module $M$, the following statements are equivalent: \par
(i) $M$ is a flat $A$-module;\par
(ii) $M_\mathfrak{p}$ is a flat $M_\mathfrak{p}$-module for each prime ideal $\mathfrak{p}$;\par
(iii) $M_\mathfrak{m}$ is a flat $M_\mathfrak{m}$-module for each maximal ideal $\mathfrak{m}$.
\end{proposition}
\begin{proof}
(i)$\Rightarrow$(ii): Suppose 
$$
0\longrightarrow N^{\prime}\longrightarrow N\longrightarrow N^{\prime\prime}\longrightarrow 0
$$
is a short exact sequence. Then 
$$
0\longrightarrow N^{\prime}\otimes _AM\longrightarrow N\otimes _AM\longrightarrow N^{\prime\prime}\otimes _AM\longrightarrow 0
$$
is a short exact sequence since $M$ is flat. Now note that $\left( N^{\prime}\otimes _AM \right) _{\mathfrak{p}}\cong N_{\mathfrak{p}}^{\prime}\otimes _{A_{\mathfrak{p}}}M_{\mathfrak{p}}$, we therefore have 
$$
0\longrightarrow N_{\mathfrak{p}}^{\prime}\otimes _{A_{\mathfrak{p}}}M_{\mathfrak{p}}\longrightarrow N_{\mathfrak{p}}\otimes _{A_{\mathfrak{p}}}M_{\mathfrak{p}}\longrightarrow N_{\mathfrak{p}}^{\prime\prime}\otimes _{A_{\mathfrak{p}}}M_{\mathfrak{p}}\longrightarrow 0
$$
a short exact sequence. Therefore $M_\mathfrak{p}$ is a flat $A_\mathfrak{p}$ module.\par
(ii)$\Rightarrow$(iii): Note that every maximal ideal is a prime ideal.\par
(iii)$\Rightarrow$(i): Suppose $N\to P$ is injective. Then $N_\mathfrak{m}\to P_\mathfrak{m}$ is injective by Proposition 8.8. Since $M_\mathfrak{m}$ is a flat $A_\mathfrak{m}$-module, we have 
$$
N_{\mathfrak{m}}\otimes _{A_{\mathfrak{m}}}M_{\mathfrak{m}}\cong \left( N\otimes _AM \right) _{\mathfrak{m}}\rightarrow \left( P\otimes _AM \right) _{\mathfrak{m}}\cong P_{\mathfrak{m}}\otimes _{A_{\mathfrak{m}}}M_{\mathfrak{m}}
$$
is injective, whence $\otimes _AM\rightarrow P\otimes _AM$ is injective. Note that an analogous argument shows that this is also true if $N\to P$ is surjective. Therefore $M$ is a flat $A$-module.
\end{proof}
\subsection{Extended and Contracted Ideals in Rings of Fractions}
Let $A$ be a ring, $S$ a multiplicatively closed subset of $A$ and $f:A\to S^{-1}A$ the natural homomorphism, defined by $f(a)=a/1$. Let $C$ be the set of concentrated ideals in $A$, and let $E$ be the set of extended ideals in $S^{-1}A$. If $\mathfrak{a}$ is an ideal in $A$, its extension $\mathfrak{a}^e$ is $S^{-1}\mathfrak{a}$, whose elements are of the form $\sum a_i/s_i$, where $a_i\in\mathfrak{a}$ and $s_i\in S$.
\begin{proposition}
(i) Every ideal in $S^{-1}A$ is an extended ideal.\par
(ii) If $\mathfrak{a}$ is an ideal of $A$, then $\mathfrak{a}^{ec}=\bigcup_{s\in S}(\mathfrak{a}:s)$. Hence $\mathfrak{a}^e=(1)$ if and only if $\mathfrak{a}$ meets $S$.\par
(iii) $\mathfrak{a}\in C$ if and only if $S$ is a zero-divisor in $A/\mathfrak{a}$.\par
(iv) The prime ideals of $S^{-1}A$ are in one-to-one correspondence $\mathfrak{p}\to S^{-1}\mathfrak{p}$ with the prime ideals of $A$ which don't meet $S$.\par
(v) The operation $S^{-1}$ commutes with formation of finite sums, products, intersections and radicals.
\end{proposition}
\begin{proof}
(i) Let $\mathfrak{b}$ be an ideal in $S^{-1}A$. Suppose $x/s\in\mathfrak{b}$, then $x/1\in\mathfrak{b}$, and hence $x\in\mathfrak{b}^c$. Therefore $x/s\in\mathfrak{b}^{ce}$, which implies $\mathfrak{b}\subset\mathfrak{b}^{ce}$. However $\mathfrak{b}\supset\mathfrak{b}^{ce}$ by Proposition 7.6, which implies $\mathfrak{b}=\mathfrak{b}^{ce}$, hence $\mathfrak{b}$ is an extended ideal of $\mathfrak{b}^{c}$.\par
(ii) Suppose $x\in\mathfrak{a}^{ec}$, then $x\in(S^{-1}\mathfrak{a})^c$ and hence $x/1=a/s$ for some $a\in\mathfrak{a}$ and $s\in S$. This implies $(sx-a)t=0$ for some $t\in S$, hence $xts=at\in\mathfrak{a}$ and $x\in\bigcup_{s\in S}(\mathfrak{a}:s)$. Note that each step in the preceding arguments are equivalent, therefore the proof is finished.\par
(iii) Suppose $x\in\mathfrak{a}^{ec}$, then since $\mathfrak{a}$ is a contracted ideal, we have $\mathfrak{a}=\mathfrak{a}^{ec}$ and hence if $sx\in\mathfrak{a}$ for some $s\in S$, we therefore have $x/s^{-1}=x/t\in\mathfrak{a}^e$ and hence $x\in\mathfrak{a}$, which implies that no $s\in S$ is a zero divisor of $A/\mathfrak{a}$. Conversely, it suffices to show that $sx\in\mathfrak{a}$ for some $s\in S$ implies $x\in\mathfrak{a}$ implies $\mathfrak{a}^{ec}\subset\mathfrak{a}$, whence $\mathfrak{a}^{ec}=\mathfrak{a}$ and hence $\mathfrak{a}\in C$. To see this, note that suppose $x\in\mathfrak{a}^{ec}$, we have $y/s=x/1$ for some $y\in\mathfrak{a}$ and $s\in S$. Therefore $(y-sx)t=0$ for some $t\in S$ and hence $stx=ty\in\mathfrak{a}$, which implies, by our assumption, $x\in\mathfrak{a}$.\par
(iv) If $\mathfrak{q}$ is prime ideal in $S^{-1}A$, then trivially $\mathfrak{q}^c$ is an ideal in $A$. Conversely, suppose $\mathfrak{p}$ is a prime ideal in $A$, then $A/\mathfrak{p}$ is an integral domain. Suppose the image of $S$ in $A/\mathfrak{p}$ is $\overline{S}$, then we have $(S^{-1}A)/(S^{-1}\mathfrak{p})\cong\overline{S}^{-1}(A/\mathfrak{p})$, which is a either zero or a subring of a field and hence an integral domain. Note by (i) that the first case follows if and only if $\mathfrak{p}$ meets $S$. This implies $S^{-1}\mathfrak{p}$ a prime ideal in $S^{-1}A$.\par
(v) It suffices to show that $S^{-1}$ commutes with radicals. Suppose $\mathfrak{a}$ is an ideal. Then trivially we have $S^{-1}r(\mathfrak{a})\subset r(S^{-1}(\mathfrak{a}))$. The converse condition is a direct verification of definitions and we omit the details.
\end{proof}
\begin{note}\em
Note that in the proof of the nilradical is the intersection of all prime ideals of the ring, we claimed that if $f$ is not nilpotent, then the set $\{f^n\}_{n\ge 0}$ contains no zero. Therefore the ring $A_f$ is nonzero and hence has a maximal ideal. The contraction $\mathfrak{p}$ of this maximal ideal does not meet $S=\{f^n\}_{n\ge 0}$, hence $f$ is not contained in this prime ideal $\mathfrak{p}$.
\end{note}
\begin{corollary}
If $\mathfrak{N}$ is the nilradical of $A$, the nilradical of $S^{-1}A$ is $S^{-1}\mathfrak{N}$.
\end{corollary}
\begin{proof}
Note that $\mathfrak{N}=r(\{0\})$, therefore $S^{-1}\mathfrak{N}=S^{-1}r(\{0\})=r(S^{-1}\{0\})$ and hence the nilradical of $S^{-1}A$.
\end{proof}
\begin{corollary}
If $\mathfrak{p}$ is a prime ideal of $A$, the prime ideals of the local ring $A_\mathfrak{p}$ are in one-to-one correspondence with the prime ideals of $A$ contained in $\mathfrak{p}$.
\end{corollary}
\begin{proof}
This follows by Proposition 8.10 with $S=A-\mathfrak{p}$.
\end{proof}
\begin{note}\em
By Corollary 8.12 we know that the passage from $A$ to $A_\mathfrak{p}$ cuts out all prime ideals except those contained in $\mathfrak{p}$. Recall that the passage from $A$ to $A/\mathfrak{p}$ cuts out all prime ideals except those containing $\mathfrak{p}$. Therefore suppose $\mathfrak{p}$ and $\mathfrak{q}$ are two prime ideals with $\mathfrak{p}\subset\mathfrak{q}$, then we first localize the ring with respect to $\mathfrak{q}$ and take quotient mod $\mathfrak{p}$, we restrict our attention to those prime ideals lies between $\mathfrak{p}$ and $\mathfrak{q}$. In particular, if $\mathfrak{p}=\mathfrak{q}$, we therefore ended up with a field, which is called the \textbf{residue field at $\mathfrak{p}$}, and can be obtained either as the field of fractions of the integral domain $A/\mathfrak{p}$ or as the residue field of the local ring $A_\mathfrak{p}$.
\end{note}
\begin{proposition}
Let $M$ be a finitely generated $A$-module, $S$ a multiplicatively closed subset of $A$. Then $S^{-1}(\mathrm{Ann}(M))=\mathrm{Ann}(S^{-1}M)$.
\end{proposition}
\begin{proof}
Suppose this is true for two modules $M$ and $N$. Then note that 
$$
\begin{aligned}
S^{-1}\left( \mathrm{Ann}\left( M+N \right) \right) &=S^{-1}\left( \mathrm{Ann}M\cap \mathrm{Ann}N \right) =S^{-1}\left( \mathrm{Ann}M \right) \cap S^{-1}\left( \mathrm{Ann}N \right) 
\\
&=\mathrm{Ann}\left( S^{-1}M \right) \cap \mathrm{Ann}\left( S^{-1}N \right) =\mathrm{Ann}\left( S^{-1}M+S^{-1}N \right) =\mathrm{Ann}\left( S^{-1}\left( M+N \right) \right) ,
\end{aligned}
$$
the proof is finished. Therefore for finitely generated modules, we may suppose $M$ is generated by a single element $x$. Therefore $M\cong A/\mathrm{Ann}(x)$ and hence 
$$
\mathrm{Ann}\left( S^{-1}M \right) \cong \mathrm{Ann}\left( S^{-1}\left( A/\mathrm{Ann}M \right) \right) =\mathrm{Ann}\left( \left( S^{-1}A \right) /\left( S^{-1}\mathrm{Ann}M \right) \right) \cong S^{-1}\mathrm{Ann}M,
$$
which finished the proof.
\end{proof}
\begin{corollary}
If $N$ and $P$ are submodules of an $A$-module $M$ and id $P$ is finitely generated, then $S^{-1}(N:P)=(S^{-1}N:S^{-1}P)$.
\end{corollary}
\begin{proof}
Note that $(N:P)=\mathrm{Ann}(N+P/N)$. Now by Proposition 8.13 we have 
$$
\begin{aligned}
S^{-1}\left( N:P \right) &=S^{-1}\left( \mathrm{Ann}\left( N+P \right) /N \right) =\mathrm{Ann}\left( S^{-1}\left( \left( N+P \right) /N \right) \right) 
\\
&=\mathrm{Ann}\left( \left( S^{-1}N+S^{-1}P \right) /S^{-1}N \right) =\left( S^{-1}N:S^{-1}P \right) ,
\end{aligned}
$$
which finished the proof.
\end{proof}